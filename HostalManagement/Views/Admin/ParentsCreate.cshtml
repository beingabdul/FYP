
@model HostalManagement.Models.Registration

@{
    ViewBag.Title = "ParentsCreate";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<h2>Register Parents</h2>
<form action="/Admin/StudentCreate" method="post">
    <div>
        <div class="form-group">
            <label>Select Student</label>
            <div class="col-md-10">
                <select class="form-control" id="FamilyNo">
                    <option value="" disabled selected>--Select Student--</option>
                    @foreach (var item in ViewBag.Students)
                    {
                        <option value="@item.RegistrationId">@item.Name</option>
                    }
                </select>
            </div>
        </div>
        <div class="form-group">
            @Html.LabelFor(model => model.Name, htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                <input id="Name" placeholder="Full Name" type="text" class="form-control" name="Name" tabindex="1" autofocus>
            </div>
        </div>
        <div class="form-group">
            @Html.LabelFor(model => model.CNIC, htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                <input id="CNIC" placeholder="XXXXX-XXXXXXX-X" type="text" class="form-control" name="CNIC" tabindex="4">
            </div>
        </div>

        <div class="form-group">
            @Html.LabelFor(model => model.ContactNo, htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                <input id="Mobile" placeholder="03XXXXXXXXX" type="text" class="form-control" name="ContactNo" tabindex="5">
            </div>
        </div>
        <div class="form-group">
            @Html.LabelFor(model => model.Email, htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                <input id="Email" placeholder="info@abc.com" type="email" class="form-control" name="Email" tabindex="7">
            </div>
        </div>
        <div class="form-group">
            @Html.LabelFor(model => model.Password, htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                <input id="Password" placeholder="Password" type="password" class="form-control" name="Password" tabindex="8">
            </div>
        </div>
    </div>

</form>
<div class="form-group col-md-12 col-lg-6">
    <button type="button" class="btn btn-primary btn-lg btn-block" tabindex="18" id="btn-Submit">
        Register
    </button>
</div>


<script src="~/Scripts/jquery-3.3.1.min.js"></script>

<script>
    $(document).on('click', '#btn-Submit', function () {
        var Name = $("#Name").val();
        var CNIC = $("#CNIC").val();
        var ContactNo = $("#Mobile").val();
        var Email = $("#Email").val();
        var Password = $("#Password").val();
        var FamilyNo = $("#FamilyNo").val();
        var CNICExp = /^[0-9+]{5}-[0-9+]{7}-[0-9]{1}$/;
        var SessionExp = /^[0-9+]{4}-[0-9+]{4}$/;
        var PasswordExp = /^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{6,16}$/;
        var emailExp = /^(([^<>()\[\]\\.,;:\s@@"]+(\.[^<>()\[\]\\.,;:\s@@"]+)*)|(".+"))@@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
        var alphaExp = "^[a-zA-Z \b-]+$";
        var mobileExp = /^((\+92)|(0092))-{0,1}\d{3}-{0,1}\d{7}$|^\d{11}$|^\d{4}-\d{7}$/;
        var bloodexp = /^(A|a|B|b|AB|ab|O|o)[-+]$/;
        if (FamilyNo == null || FamilyNo == '') {
            alert('Family Mobile Number is Required');
            return false;
        }
        else if (Name == null || Name == '') {
            alert('Name is Required');
            return false;
        }
        else if (!Name.match(alphaExp)) {
            alert('Invalid Name ! e.g Qamar Javed Bajwa');
            return false;
        }
        else if (CNIC == null || CNIC == '') {
            alert('CNIC is Required');
            return false;
        }
        else if (!CNIC.match(CNICExp)) {
            alert('Invalid CNIC ! e.g 12345-1234567-1');
            return false;
        }
        else if (ContactNo == null || ContactNo == '') {
            alert('Mobile Number is Required');
            return false;
        }
        else if (!ContactNo.match(mobileExp)) {
            alert('Invalid mobile ! e.g 03121234567,00923331234567');
            return false;
        }
        else if (Email == null || Email == '') {
            alert('Email is Required');
            return false;
        }
        else if (!Email.match(emailExp)) {
            alert('Invalid Email ! e.g user@example.com');
            return false;
        }
        else if (Password == null || Password == '') {
            alert('Password is Required');
            return false;
        }
        var data = new FormData();
        data.append("Name", Name);
        data.append("Email", Email);
        data.append("ContactNo", ContactNo);
        data.append("CNIC", CNIC);
        data.append("Password", Password);
        data.append("FamilyNo", FamilyNo);
        $.ajax({
            type: "POST",
            cache: false,
            url: "/Admin/ParentsCreate",
            data: data,
            processData: false,
            contentType: false,
            success: function (Rdata) {
                if (Rdata != 'error' && Rdata != 'yes') {
                    Swal.fire(
                        {
                            title: 'Registered!',
                            text: 'Parent registered successfully!',
                            icon: 'success',
                            showCancelButton: false,
                            confirmButtonColor: '#5b73e8',
                            cancelButtonColor: "#f46a6a"
                        }
                    ).then(() => {
                        location.href = "/Admin/ParentsList";
                    })

                }
                else if (Rdata == 'yes') {
                    Swal.fire({
                        position: 'top-end',
                        icon: 'error',
                        title: 'Exist',
                        text: 'User already exist..!',
                        showConfirmButton: false,
                        timer: 15000
                    })
                }
                else {
                    Swal.fire({
                        position: 'top-end',
                        icon: 'error',
                        title: 'Error',
                        text: 'Database Error..!',
                        showConfirmButton: false,
                        timer: 15000
                    })
                }
            },
        });
    });
</script>


